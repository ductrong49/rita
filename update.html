<!DOCTYPE html>
<html lang="vi">
<head><meta charset="UTF-8"><title>Cập nhật TKB</title></head>
<body>
  <h1>Cập nhật Thời khóa biểu</h1>
  <form id="formUpdate">
    <label>Thứ: <input name="day" value="Thứ 2"></label><br>
    <label>Buổi: <input name="session" value="morning"></label><br>
    <label>Môn 1: <input name="mon1"></label><br>
    <label>Môn 2: <input name="mon2"></label><br>
    <label>Môn 3: <input name="mon3"></label><br>
    <label>Môn 4: <input name="mon4"></label><br>
    <label>Môn 5: <input name="mon5"></label><br>
    <button type="submit">Gửi</button>
  </form>
  <div id="status"></div>

  <script>
    const API_URL = "https://script.google.com/macros/s/AKfycbzUlelXCN8Z7UG6fzCTZai_w4lWdISfS3E-kbFJDq34Of4ypyuVE442SaXclAk6nDhD/exec";
    document.getElementById("formUpdate").addEventListener("submit", async e => {
      e.preventDefault();
      const form = new FormData(e.target);
      const obj = {};
      form.forEach((v,k) => obj[k] = v);
      try {
        const res = await fetch(API_URL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(obj)
        });
        const json = await res.json();
        document.getElementById("status").innerText = json.status === "success"
          ? "Đã lưu thành công!"
          : `Lỗi: ${json.message || "Không rõ"}`;
      } catch (err) {
        document.getElementById("status").innerText = "Không thể kết nối API.";
        console.error(err);
      }
    });
  </script>
</body>
</html>
