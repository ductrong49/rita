<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Thời khóa biểu</title>
<style>
    body {
        font-family: Arial, sans-serif;
        background: #f0f0f0;
        margin: 0;
        padding: 0;
        text-align: center;
    }
    h1 {
        background-color: #4CAF50;
        color: white;
        padding: 15px;
        margin: 0;
    }
    table {
        margin: 20px auto;
        border-collapse: collapse;
        background: white;
        box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    th, td {
        border: 1px solid #ccc;
        padding: 10px;
    }
    th {
        background-color: #2E7D32;
        color: white;
    }
</style>
</head>
<body>

<h1>Thời khóa biểu</h1>
<table id="scheduleTable">
    <thead>
        <tr id="headerRow"></tr>
    </thead>
    <tbody id="dataRows"></tbody>
</table>

<script>
    const apiUrl = "https://script.google.com/macros/s/AKfycbzTElxNBgS5_ZhoFR-JxRtUKUeGox70eh3p_Z9O6p9XZmm1YYJD3KhaCbGYojqVtPOx/exec";

    async function loadData() {
        try {
            const res = await fetch(apiUrl);
            if (!res.ok) throw new Error("Lỗi kết nối API");
            const data = await res.json();

            if (!Array.isArray(data) || data.length === 0) {
                document.getElementById("scheduleTable").innerHTML = "<tr><td>Không có dữ liệu</td></tr>";
                return;
            }

            const headerRow = document.getElementById("headerRow");
            headerRow.innerHTML = "";
            data[0].forEach(cell => {
                let th = document.createElement("th");
                th.textContent = cell;
                headerRow.appendChild(th);
            });

            const dataRows = document.getElementById("dataRows");
            dataRows.innerHTML = "";
            for (let i = 1; i < data.length; i++) {
                let tr = document.createElement("tr");
                data[i].forEach(cell => {
                    let td = document.createElement("td");
                    td.textContent = cell;
                    tr.appendChild(td);
                });
                dataRows.appendChild(tr);
            }

        } catch (error) {
            document.getElementById("scheduleTable").innerHTML = `<tr><td colspan="10">Lỗi tải dữ liệu: ${error.message}</td></tr>`;
        }
    }

    loadData();
</script>

</body>
</html>
