<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Thời Khóa Biểu</title>
<style>
    body {
        font-family: Arial, sans-serif;
        text-align: center;
        background: #f8f9fa;
        margin: 0;
        padding: 20px;
    }
    h1 {
        margin-bottom: 20px;
    }
    table {
        border-collapse: collapse;
        margin: 0 auto;
        background: white;
        box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    th, td {
        border: 1px solid #ccc;
        padding: 8px 12px;
        min-width: 100px;
    }
    th {
        color: white;
    }
    .thu2 { background: #4caf50; }
    .thu3 { background: #2196f3; }
    .thu4 { background: #ff9800; }
    .thu5 { background: #9c27b0; }
    .thu6 { background: #009688; }
    .thu7 { background: #e91e63; }
    .buoi {
        background: #eee;
        font-weight: bold;
        text-align: left;
    }
</style>
<script src="https://www.gstatic.com/charts/loader.js"></script>
<script>
google.charts.load('current', {packages: ['corechart']});
google.charts.setOnLoadCallback(loadData);

function loadData() {
    const query = new google.visualization.Query(
        'https://docs.google.com/spreadsheets/d/1ckCsWVDPa7qw2NjuBrOjySMZGEb2vCnuGIgXS5l9IM8/gviz/tq?tqx=out:json'
    );
    query.send(handleData);
}

function handleData(response) {
    if (response.isError()) {
        alert('Lỗi tải dữ liệu: ' + response.getMessage());
        return;
    }

    const data = response.getDataTable();
    let html = '<table>';
    html += '<tr><th></th>' +
            '<th class="thu2">Thứ 2</th>' +
            '<th class="thu3">Thứ 3</th>' +
            '<th class="thu4">Thứ 4</th>' +
            '<th class="thu5">Thứ 5</th>' +
            '<th class="thu6">Thứ 6</th>' +
            '<th class="thu7">Thứ 7</th></tr>';

    // Buổi sáng
    html += '<tr><td class="buoi" colspan="7">Buổi sáng</td></tr>';
    for (let row = 2; row <= 6; row++) { // hàng 3-7 trong sheet (index bắt đầu từ 0)
        html += `<tr><td>Tiết ${row - 1}</td>`;
        for (let col = 1; col <= 6; col++) { // B → G
            html += `<td>${data.getFormattedValue(row, col) || ''}</td>`;
        }
        html += '</tr>';
    }

    // Buổi chiều
    html += '<tr><td class="buoi" colspan="7">Buổi chiều</td></tr>';
    for (let row = 8; row <= 12; row++) { // hàng 9-13
        html += `<tr><td>Tiết ${row - 7}</td>`;
        for (let col = 1; col <= 6; col++) { // B → G
            html += `<td>${data.getFormattedValue(row, col) || ''}</td>`;
        }
        html += '</tr>';
    }

    html += '</table>';
    document.getElementById('tkb').innerHTML = html;
}
</script>
</head>
<body>
    <h1>THỜI KHÓA BIỂU</h1>
    <div id="tkb">Đang tải dữ liệu...</div>
</body>
</html>
